@page
@model LoyalKullaniciTakip.Pages.Izin.ListModel
@{
    ViewData["Title"] = "İzin Talepleri";
}

<h1>İzin Talepleri</h1>

<p>
    <a asp-page="Create" class="btn btn-primary">Yeni İzin Talebi Oluştur</a>
</p>

<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>Personel</th>
            <th>İzin Tipi</th>
            <th>Başlangıç</th>
            <th>Bitiş</th>
            <th>Talep Tarihi</th>
            <th>Durum</th>
            <th>Onaylayan</th>
            <th>İşlemler</th>
        </tr>
    </thead>
    <tbody>
        @foreach (var item in Model.IzinTalepleri)
        {
            var durumClass = item.OnayDurumu switch
            {
                0 => "table-warning",
                1 => "table-success",
                2 => "table-danger",
                _ => ""
            };
            var durumText = item.OnayDurumu switch
            {
                0 => "Bekliyor",
                1 => "Onaylandı",
                2 => "Reddedildi",
                _ => "Bilinmiyor"
            };

            <tr class="@durumClass">
                <td>@item.Personel.Ad @item.Personel.Soyad</td>
                <td>@item.IzinTipi.Tanim</td>
                <td>@item.BaslangicTarihi.ToString("dd.MM.yyyy")</td>
                <td>@item.BitisTarihi.ToString("dd.MM.yyyy")</td>
                <td>@item.TalepTarihi.ToString("dd.MM.yyyy HH:mm")</td>
                <td>
                    <strong>@durumText</strong>
                </td>
                <td>
                    @if (item.OnaylayanPersonel != null)
                    {
                        @item.OnaylayanPersonel.Ad @item.OnaylayanPersonel.Soyad
                    }
                    else
                    {
                        <span class="text-muted">-</span>
                    }
                </td>
                <td>
                    <a asp-page="./Details" asp-route-talepId="@item.TalepID" class="btn btn-sm btn-info">Detay</a>
                </td>
            </tr>
        }
    </tbody>
</table>

@if (!Model.IzinTalepleri.Any())
{
    <div class="alert alert-info">
        Henüz izin talebi bulunmamaktadır.
    </div>
}

